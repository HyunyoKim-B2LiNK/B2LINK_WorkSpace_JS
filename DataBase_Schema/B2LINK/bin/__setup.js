var fileNm="__setup.js";console,require("./_$TATIC_CONST_TtwApplicationCommon.js");var g=global;g.FILE_NM__DB_SYSTEM_JS_REMOVE="_db.system.js.remove.js",g.FILE_NM__CREATE_DB_AND_USER="_create_DB_And_User",g.PATH_BIN="E:/WorkSpace_MongoDB_Schema__B2LINK/bin/",g.PATH_BIN_ADMIN="execute_mongoclient_js__admin ",g.PATH_BIN_DATABASE="execute_mongoclient_js__database ",g.PASSWORD_R="_r_qlxnfldzmdkfEjqmffb!",g.PASSWORD_RW="_rw_qlxnfldzmdkfEjqmffb!",g.execute_mongoclient__AddProcedure=function(e,t){var _='"b2link_'+e+'_rw"',r='"b2link_'+e+g.PASSWORD_RW+'"',a=g.PATH_BIN_DATABASE+io+" "+_+" "+r+" "+t+" > "+t+".result",i=STtwUtilCP.sExec(a),n=i.indexOf("error");n>-1&&STtwUtilFsWriteStream.writeFile(t+".errorResult",i)},g.execute_mongoclient__CreateDBAndUser=function(e,t){var _=g.FILE_NM__CREATE_DB_AND_USER+".dbjs",r=t+_,a=g.PATH_BIN_ADMIN+r+" > "+r+".result";try{var i=STtwUtilCP.sExec(a),n=i.indexOf("error");n>-1&&STtwUtilFsWriteStream.writeFile(r+".errorResult",i)}catch(o){}},g.execute_mongoclient__DB_JS_Remove=function(e,t){var _='"b2link_'+e+'_rw"',r='"b2link_'+e+g.PASSWORD_RW+'"',a=g.PATH_BIN_DATABASE+e+" "+_+" "+r+" "+t+g.FILE_NM__DB_SYSTEM_JS_REMOVE+".dbjs > "+t+g.FILE_NM__DB_SYSTEM_JS_REMOVE+".dbjs.result";try{STtwUtilCP.sExec(a)}catch(i){}},g.fileSave__dbs=function(e,t){STtwUtilFsWriteStream.writeFile(e,t)},g.fileSave_dbjs_createDBAndUser=function(e,t){var _='"b2link_'+e+'_r"',r='"b2link_'+e+'_rw"',a='"b2link_'+e+g.PASSWORD_R+'"',i='"b2link_'+e+PASSWORD_RW+'"',n='\nvar db0 = db.getSiblingDB( "'+e+'" );\ndb0.createUser({ user : '+_+", pwd : "+a+', roles : [ "dbOwner", "read" ] });\ndb0.createUser({ user : '+r+", pwd : "+i+', roles : [ "dbOwner", "readWrite" ] });';STtwUtilFsWriteStream.writeFile(t+e+"/"+g.FILE_NM__CREATE_DB_AND_USER+".dbjs",n)},g.fileSave_dbjs_removeAllProcesure=function(e,t){var _='try{ db.getSiblingDB( "'+e+'" ).system.js.remove({}); }\ncatch( er ){ print( er ); }';STtwUtilFsWriteStream.writeFile(t+e+"/"+g.FILE_NM__DB_SYSTEM_JS_REMOVE+".dbjs",_)},g.getScript_DB=function(e,t,_,r){var a='db.getSiblingDB( "'+e+'" ).addJSFunc( "';return"_common_procedure"==t||(_=t+"$"+_),a=a+_+'", '+r+" );"};var path0="../database/",path1,path2,path3,path4,f0=STtwUtilFsReadStream.getList_File_Extension,f1=STtwUtilFsWriteStream.writeFile,f2=STtwUtilFsReadStream.getFile,aCPath0=STtwUtilFsReadStream.getList_Directory(path0);f1(path0+"__list.json",JSON.stringify(aCPath0,null,"	"));for(var aCPath1,a,io,i=0,iLen=aCPath0.length;iLen>i;++i){io=aCPath0[i],g.fileSave_dbjs_createDBAndUser(io,path0),g.fileSave_dbjs_removeAllProcesure(io,path0),path1=path0+io+"/",g.execute_mongoclient__CreateDBAndUser(io,path1),g.execute_mongoclient__DB_JS_Remove(io,path1),aCPath1=STtwUtilFsReadStream.getList_Directory(path1),aCPath1.unshift(aCPath1.pop());for(var jo,j=0,jLen=aCPath1.length;jLen>j;++j){jo=aCPath1[j],path2=path1+jo+"/";try{a=f0(path2,".js")}catch(er){continue}for(var ko,k=0,kLen=a.length;kLen>k;++k){ko=a[k],path3=path2+ko;var sJS=f2(path3).toString("utf8"),nExt_ko=ko.replace(".js",""),sJS=g.getScript_DB(io,jo,nExt_ko,sJS);path4=path3+".dbs",g.fileSave__dbs(path4,sJS),g.execute_mongoclient__AddProcedure(io,path4)}a.length=0}aCPath1.length=0}aCPath0.length=0,global.process.exit(),console;